---
- name: install hhvm gpg key
  apt_key: url=http://dl.hhvm.com/conf/hhvm.gpg.key state=present

- name: add hhvm deb repository
  apt_repository: repo='deb http://dl.hhvm.com/ubuntu trusty main' state=present

- name: install hhvm packages
  apt: name=hhvm state=latest update_cache=yes
  notify: restart hhvm

- name: check hhvm path
  shell: which hhvm
  register: current_hhvm
  changed_when: False

- name: symlink hhvm as php
  file: src="{{ current_hhvm.stdout }}" dest=/usr/bin/php state=link

- name: start hhvm service
  service: name=hhvm state=started